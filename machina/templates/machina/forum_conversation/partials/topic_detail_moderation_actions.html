{% load i18n %}
{% load forum_permission_tags %}

{% get_permission 'can_add_post' request.user topic=topic as user_can_add_post %}
{% get_permission 'can_lock_topics' request.user forum=topic.forum as user_can_lock_topics %}
{% get_permission 'can_move_topics' request.user forum=topic.forum as user_can_move_topics %}
{% get_permission 'can_delete_topics' request.user forum=topic.forum as user_can_delete_topics %}
{% if user_can_add_post %}
    <a href="{% url 'forum-conversation:post-create' forum.slug forum.pk topic.slug topic.pk %}" class="btn btn-primary btn-sm"><i class="fa fa-comment fa-lg"></i>&nbsp;{% trans "Post reply" %}</a>
{% endif %}
{% if user_can_lock_topics and not topic.is_locked or user_can_move_topics or user_can_delete_topics %}
    <div class="dropdown moderation-dropdown">
        <button class="btn btn-warning btn-sm dropdown-toggle" type="button" data-toggle="dropdown"><i class="fa fa-gavel">&nbsp;&nbsp;</i><span class="caret"></span></button>
        <ul class="dropdown-menu">
            {% if user_can_lock_topics and not topic.is_locked %}<li><a href="{% url 'forum-moderation:topic-lock' slug=topic.slug pk=topic.pk %}">{% trans "Lock topic" %}</a></li>{% endif %}
            {% if user_can_lock_topics and topic.is_locked %}<li><a href="{% url 'forum-moderation:topic-unlock' slug=topic.slug pk=topic.pk %}">{% trans "Unlock topic" %}</a></li>{% endif %}
            {% if user_can_delete_topics %}<li><a href="{% url 'forum-moderation:topic-delete' slug=topic.slug pk=topic.pk %}">{% trans "Delete topic" %}</a></li>{% endif %}
            {% if user_can_move_topics %}<li><a href="{% url 'forum-moderation:topic-move' slug=topic.slug pk=topic.pk %}">{% trans "Move topic" %}</a></li>{% endif %}
        </ul>
    </div>
{% endif %}