{% load i18n %}

<ul class="pagination {{ pagination_size|default:"" }}">
    <li class="prev {% if not page.has_previous %}disabled{% endif %}">
        <a href="{% if page.has_previous %}?q={{ query }}&amp;page={{ page.previous_page_number }}{% endif %}">&laquo;</a>
    </li>
    {% for number in page.paginator.page_range %}
        {% if page.number == number %}
            <li class="active"><a href="?q={{ query }}&amp;page={{ number }}">{{ number }}</a></li>
        {% else %}
            {% if forloop.first %}
                <li><a href="?q={{ query }}&amp;page={{ number }}">{{ number }}</a></li>
                {% if page.number > 3 %}
                    <li><span>...</span></li>
                {% endif %}
            {% elif forloop.last %}
                {% if page.number < page.paginator.num_pages|add:"-2" %}
                    <li><span>...</span></li>
                {% endif %}
                <li><a href="?q={{ query }}&amp;page={{ number }}">{{ number }}</a></li>
            {% else %}
                {% if number == page.previous_page_number or number == page.next_page_number %}
                    <li><a href="?q={{ query }}&amp;page={{ number }}">{{ number }}</a></li>
                {% endif %}
            {% endif %}
        {% endif %}
    {% endfor %}
    <li class="next {% if not page.has_next %}disabled{% endif %}">
        <a href="{% if page.has_next %}?q={{ query }}&amp;page={{ page.next_page_number }}{% endif %}" >&raquo;</a>
    </li>
</ul>