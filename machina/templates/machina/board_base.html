{% extends "base.html" %}
{% load url from future %}
{% load static %}
{% load i18n %}
{% load compress %}
{% load forum_permission_tags %}

{% block title %}{{ MACHINA_FORUM_NAME|default:"Forum" }} &mdash; {% block sub-title %}{% endblock sub-title %}{% endblock title %}

{% block css %}
    {% compress css %}
        <link rel="stylesheet" type="text/less" href="{% static 'machina/_libs/bootstrap/less/bootstrap.less' %}" />
        <link rel="stylesheet" type="text/less" href="{% static 'machina/_libs/font-awesome/less/font-awesome.less' %}" />
        <link rel="stylesheet" type="text/less" href="{% static 'machina/less/board_theme.less' %}" />
    {% endcompress %}
{% endblock css %}

{% block body %}
    {% block header %}
        <div class="navbar-fixed-top-spacing">&nbsp;</div>
        <div class="navbar navbar-default navbar-fixed-top machina-navbar" role="navigation">
            <div class="container"> 
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">django-machina</a>
                </div>
                <div class="collapse navbar-collapse">
                    {% block header_collapse %}
                        <div class="col-sm-7 col-md-8 col-lg-5">
                            <form class="navbar-form form-inline" role="search" action="{% url 'forum-search:search' %}">
                                <div class="form-group col-sm-7 col-md-8">
                                    <div class="input-group">
                                        <input type="text" class="form-control" placeholder="{% trans 'Search...' %}" name="q">
                                        <div class="input-group-btn">
                                            <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <a href="{% url 'forum-search:search' %}" class="btn btn-link">{% trans "Advanced search" %}</a>
                                </div>
                            </form>
                        </div>
                    {% endblock header_collapse %}
                </div>
            </div>
        </div>
    {% endblock header %}
    <div class="container" id="main_container">
        <div class="row">
            <div class="col-xs-12">
                {% block breadcrumb %}
                    {% include "machina/partials/breadcrumb.html" %}
                {% endblock breadcrumb %}
                <div class="pull-right controls-link-wrapper">
                    {% if not request.user.is_anonymous %}
                        <a href="{% url 'forum-member:user-topics' %}" class="btn btn-link"><i class="fa fa-comments-o ">&nbsp;</i>{% trans "View my messages" %}</a>
                    {% endif %}
                    {% get_permission 'can_access_moderation_panel' request.user as user_can_access_moderation_panel %}
                    {% if user_can_access_moderation_panel %}
                        <a href="#" class="btn btn-link"><i class="fa fa-gavel">&nbsp;</i>{% trans "Moderation panel" %}</a>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                {% block messages %}
                    {% include "machina/partials/messages.html" %}
                {% endblock messages %}
            </div>
        </div>
        {% block content %}
        {% endblock content %}
    </div>
{% endblock body %}

{% block js %}
    {% compress js %}
        <script type="text/javascript" src="{% static 'machina/_libs/jquery/dist/jquery.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'machina/_libs/bootstrap/dist/js/bootstrap.min.js' %}"></script>
        <script src="{% static 'machina/js/ui.js' %}" type="text/javascript" charset="utf-8"></script>
    {% endcompress %}
    <script type="text/javascript">
        $(function() {
            machina.init();
            {% block onbodyload %}{% endblock onbodyload %}
        });
    </script>
{% endblock js %}
